
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>loopleSheet &#8212; loopleSheet  documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'README';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="loopleSheet" href="modules.html" />
    <link rel="prev" title="Welcome to loopleSheetâ€™s documentation!" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">loopleSheet  documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item current active">
                    <a class="nav-link" href="#">
                        User Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="modules.html">
                        loopleSheet
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item current active">
                    <a class="nav-link" href="#">
                        User Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="modules.html">
                        loopleSheet
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="looplesheet">
<h1>loopleSheet<a class="headerlink" href="#looplesheet" title="Permalink to this heading">#</a></h1>
<p><strong>The purpose of this library is to provide a subroutine wrapper connected to a Google Sheet. It implements the main loop (calling the subroutine in a loop) and interacts with a Google Sheet.</strong></p>
<p>This library allows the rapid deployment of a robot and offers a tracking of it. This can be relevant for example in the context of Raspeberry Pi boards.</p>
<p>A full documentation is available <a class="reference external" href="https://antnlocks.github.io/loopleSheet/doc/build/html/index.html">here</a>.</p>
<p><strong>Features:</strong></p>
<ul class="simple">
<li><p>sleep time between 2 executions of the subroutine is read from the Google Sheet</p></li>
<li><p>display the date and time of the last execution of the subroutine in the Google Sheet</p></li>
<li><p>allow to post messages in the Google Sheet. These messages are automatically time-stamped</p></li>
</ul>
<p>In order to use this library, you need to have a Google account and you need to accept the Terms of use of Google Cloud Platform.</p>
<section id="installing">
<h2>Installing<a class="headerlink" href="#installing" title="Permalink to this heading">#</a></h2>
<p>You can install this library using:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install loopleSheet
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python3 -m pip install loopleSheet
</pre></div>
</div>
</section>
<section id="useful-information">
<h2>Useful Information<a class="headerlink" href="#useful-information" title="Permalink to this heading">#</a></h2>
<p>In order to work with a Google Sheet, <code class="docutils literal notranslate"><span class="pre">loopleSheet</span></code> need 2 elements:</p>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">key</span></code> of the Google Sheet (a.k.a <em>Spreadsheet ID</em>)</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">.json</span></code> file with <em>access credentials</em></p></li>
</ul>
<section id="getting-a-spreadsheet-id">
<h3>Getting a Spreadsheet ID<a class="headerlink" href="#getting-a-spreadsheet-id" title="Permalink to this heading">#</a></h3>
<p>You can get the Spredsheet ID of a Google Sheet from the url used when you edit the Google Sheet online. It is the part between <code class="docutils literal notranslate"><span class="pre">https://docs.google.com/spreadsheets/d/</span></code> and <code class="docutils literal notranslate"><span class="pre">/edit#gid=0</span></code>.</p>
<p>For example, in the url <code class="docutils literal notranslate"><span class="pre">https://docs.google.com/spreadsheets/d/1LzDqgfWea1cIafGnXhIc2OEFCHzoFOSdO1qsSlK3rGk/edit#gid=0</span></code>, the Spreadsheet ID is <em>1LzDqgfWea1cIafGnXhIc2OEFCHzoFOSdO1qsSlK3rGk</em>.</p>
</section>
<section id="creating-access-credentials">
<h3>Creating access credentials<a class="headerlink" href="#creating-access-credentials" title="Permalink to this heading">#</a></h3>
<p>This library uses Google <code class="docutils literal notranslate"><span class="pre">Service</span> <span class="pre">account</span></code> credentials. You can follow this <a class="reference external" href="https://developers.google.com/workspace/guides/create-credentials#service-account">documentation</a> for creating a <em>Project</em> and a <em>Service account</em>. Donâ€™t forget to select Google Sheet API when you are asked which API you want to use.</p>
<p>At the end of the process, you should have downloaded the <code class="docutils literal notranslate"><span class="pre">.json</span></code> file.</p>
</section>
<section id="authorizing-the-service-account-to-edit-the-google-sheet">
<h3>Authorizing the Service account to edit the Google Sheet<a class="headerlink" href="#authorizing-the-service-account-to-edit-the-google-sheet" title="Permalink to this heading">#</a></h3>
<p>If you havenâ€™t shared your Google Sheet, it can only be edited by you (the Google account that created the Google Sheet). So, in order for the Service account to edit the Google Sheet, you must share it with them.</p>
<p>The Service account has an email address. You can find it in your Google Cloud Console or more easily in the <code class="docutils literal notranslate"><span class="pre">.json</span></code> (tag <code class="docutils literal notranslate"><span class="pre">&quot;client_email&quot;</span></code>). Just share the Google Sheet with this specific email address or with anyone if youâ€™re fine with it. Donâ€™t forget to allow modifications.</p>
</section>
</section>
<section id="google-sheet-template">
<h2>Google Sheet template<a class="headerlink" href="#google-sheet-template" title="Permalink to this heading">#</a></h2>
<p>Your Google Sheet is not processed by <code class="docutils literal notranslate"><span class="pre">loopleSheet</span></code>, so donâ€™t expect some clever behaviour.
I suggest your Google Sheet to be like this one :</p>
<p><img alt="" src="_images/gsheet_template.png" /></p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">loopleSheet</span></code>:</p>
<ul class="simple">
<li><p>expects in the <code class="docutils literal notranslate"><span class="pre">B1</span></code> cell the number of seconds to sleep between 2 executions</p></li>
<li><p>will write the date and time of the last performed execution in the <code class="docutils literal notranslate"><span class="pre">A4</span></code> cell</p></li>
<li><p>will write the messages you want to post in the <code class="docutils literal notranslate"><span class="pre">C</span></code> column with the associated date and time in the <code class="docutils literal notranslate"><span class="pre">D</span></code> column</p></li>
<li><p>works on the <code class="docutils literal notranslate"><span class="pre">first</span></code> sheet of the Google Sheet</p></li>
</ul>
<p>You can edit this behavior.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">loopleSheet</span> <span class="k">as</span> <span class="nn">ls</span>

<span class="k">def</span> <span class="nf">subroutine</span><span class="p">(</span><span class="n">loopleSht</span><span class="p">):</span>
	<span class="c1"># Doing some work...</span>

	<span class="k">if</span> <span class="n">special_result</span><span class="p">:</span>
		<span class="n">loopleSht</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;New info found ! [...]&#39;</span><span class="p">)</span>


<span class="c1"># The .json is next to the script</span>
<span class="n">ls</span><span class="o">.</span><span class="n">LoopleSheet</span><span class="p">(</span><span class="n">json_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;/credentials.json&#39;</span><span class="p">,</span>
<span class="n">spreadsheet_id</span><span class="o">=</span><span class="s1">&#39;1LzDqgfWea1cIafGnXhIc2OEFCHzoFOSdO1qsSlK3rGk&#39;</span><span class="p">,</span>
<span class="n">runnable</span><span class="o">=</span><span class="n">subroutine</span><span class="p">,</span>
<span class="n">catchingExceptionsFromRunnable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>Note: You may have to kill the script in order to finish it</p>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="index.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Welcome to loopleSheetâ€™s documentation!</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="modules.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">loopleSheet</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installing">
   Installing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#useful-information">
   Useful Information
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-a-spreadsheet-id">
     Getting a Spreadsheet ID
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-access-credentials">
     Creating access credentials
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#authorizing-the-service-account-to-edit-the-google-sheet">
     Authorizing the Service account to edit the Google Sheet
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#google-sheet-template">
   Google Sheet template
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples">
   Examples
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="_sources/README.md.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, Antoine LORENTZ.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>